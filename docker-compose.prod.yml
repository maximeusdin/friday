version: '3.8'

services:
  api:
    build:
      context: .
      dockerfile: backend/Dockerfile
    container_name: friday_api
    ports:
      - "80:8000"
    environment:
      # AWS RDS Database (password from Secrets Manager or .env file)
      DATABASE_URL: ${DATABASE_URL:-postgresql://friday:${DB_PASS}@friday-postgres.cheoc40uk4v7.us-west-1.rds.amazonaws.com:5432/friday?sslmode=verify-full&sslrootcert=/etc/ssl/certs/rds-global-bundle.pem}
      # OpenAI API key for LLM features
      OPENAI_API_KEY: ${OPENAI_API_KEY:-}
      # Don't load .env from dotenv, we use Docker env
      FRIDAY_LOAD_DOTENV: "0"
    restart: unless-stopped
